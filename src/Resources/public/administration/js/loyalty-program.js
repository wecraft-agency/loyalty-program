!function(){"use strict";var e={};e.p="bundles/loyaltyprogram/",window?.__sw__?.assetPath&&(e.p=window.__sw__.assetPath+"/bundles/loyaltyprogram/"),function(){let{Component:e,Mixin:t}=Shopware,{Criteria:a}=Shopware.Data;e.register("loyalty-reward-list",{template:'{% block loyalty_reward_list %}\r\n\r\n    <sw-page class="loyalty-reward-list">\r\n\r\n        {% block loyalty_reward_list_smart_bar_header %}\r\n            <template #smart-bar-header>\r\n                {% block loyalty_reward_list_smart_bar_header_title %}\r\n                    <h2>\r\n                        {% block loyalty_reward_list_smart_bar_header_title_text %}\r\n                            {{ $tc(\'loyalty-program.general.rewardsLabel\') }}\r\n                        {% endblock %}\r\n\r\n                        {% block loyalty_reward_list_smart_bar_header_amount %}\r\n                            <span v-if="!isLoading" class="sw-page__smart-bar-amount">\r\n                        ({{ total }})\r\n                        </span>\r\n                        {% endblock %}\r\n                    </h2>\r\n                {% endblock %}\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_list_smart_bar_language %}\r\n            <template #language-switch>\r\n                <sw-language-switch @on-change="onChangeLanguage"></sw-language-switch>\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_list_smart_bar_actions %}\r\n            <template #smart-bar-actions>\r\n                {% block loyalty_reward_list_smart_bar_actions_add %}\r\n                    <sw-button variant="primary" :routerLink="{ name: \'loyalty.program.rewards.create\' }">\r\n                        {{ $tc(\'loyalty-program.rewards.general.create\') }}\r\n                    </sw-button>\r\n                {% endblock %}\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_list_cardview %}\r\n            <template #content>\r\n                <div class="loyalty-reward-list__content">\r\n                    {% block loyalty_reward_list_content %}\r\n                        <sw-entity-listing class="loyalty-reward-list-grid"\r\n                                           v-if="items && total > 0"\r\n                                           :items="items"\r\n                                           :repository="entityRepository"\r\n                                           detailRoute="loyalty.program.rewards.detail"\r\n                                           :showSeleciton="true"\r\n                                           :isLoading="isLoading"\r\n                                           :columns="columns">\r\n\r\n                            <template #pagination>\r\n                                {% block sw_order_list_grid_pagination %}\r\n                                    <sw-pagination :page="page"\r\n                                                   :limit="limit"\r\n                                                   :total="total"\r\n                                                   :total-visible="7"\r\n                                                   @page-change="onPageChange">\r\n                                    </sw-pagination>\r\n                                {% endblock %}\r\n                            </template>\r\n\r\n                        </sw-entity-listing>\r\n                    {% endblock %}\r\n\r\n                    {% block loyalty_reward_list_empty_state %}\r\n                        <sw-empty-state v-if="!isLoading && total === 0" :title="$tc(\'loyalty-program.rewards.list.contentEmpty\')"></sw-empty-state>\r\n                    {% endblock %}\r\n\r\n                </div>\r\n            </template>\r\n        {% endblock %}\r\n\r\n    </sw-page>\r\n{% endblock %}\r\n',inject:["repositoryFactory"],mixins:[t.getByName("listing"),t.getByName("notification"),t.getByName("placeholder")],data(){return{items:null,isLoading:!1,showDeleteModal:!1,repository:null,total:0}},metaInfo(){return{title:this.$createTitle()}},computed:{entityRepository(){return this.repositoryFactory.create("loyalty_reward")},columns(){return this.getColumns()}},methods:{getList(){this.isLoading=!0;let e=new a(this.page,this.limit);this.entityRepository.search(e,Shopware.Context.api).then(e=>(this.total=e.total,this.items=e,this.isLoading=!1,e)).catch(()=>{this.isLoading=!1})},onDelete(e){this.showDeleteModal=e},onCloseDeleteModal(){this.showDeleteModal=!1},getColumns(){return[{property:"name",dataIndex:"name",inlineEdit:"string",routerLink:"loyalty.program.rewards.detail",label:this.$tc("loyalty-program.rewards.list.nameLabel"),allowResize:!0,primary:!0},{property:"type",dataIndex:"type",inlineEdit:"string",label:this.$tc("loyalty-program.rewards.list.typeLabel"),allowResize:!0,primary:!0},{property:"points",dataIndex:"points",inlineEdit:"number",label:this.$tc("loyalty-program.rewards.list.pointsLabel"),allowResize:!0,primary:!0},{property:"active",label:this.$tc("loyalty-program.rewards.list.active"),inlineEdit:"boolean"}]},onChangeLanguage(e){this.getList(e)}}});let{Component:r}=Shopware,{Criteria:l}=Shopware.Data,{Mixin:n}=Shopware;r.register("loyalty-reward-detail",{template:'{% block loyalty_reward_detail %}\r\n    <sw-page class="loyalty-reward-detail" v-if="item">\r\n\r\n        {% block loyalty_reward_detail_smart_bar_header %}\r\n            <template #smart-bar-header>\r\n                {% block loyalty_reward_detail_smart_bar_header_title %}\r\n                    <h2>{{ $tc(\'loyalty-program.general.rewardsSingularLabel\') }}</h2>\r\n                {% endblock %}\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_detail_smart_bar_language %}\r\n            <template #language-switch>\r\n                <sw-language-switch @on-change="onChangeLanguage"\r\n                                    :disabled="$route.params.newItem"></sw-language-switch>\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_detail_smart_bar_actions %}\r\n            <template #smart-bar-actions>\r\n                {% block loyalty_reward_detail_smart_bar_actions_cancel %}\r\n                    <sw-button :disabled="item.isLoading" :routerLink="{ name: \'loyalty.program.rewards.index\' }">\r\n                        {{ $tc(\'loyalty-program.rewards.general.buttonCancel\') }}\r\n                    </sw-button>\r\n                {% endblock %}\r\n\r\n                {% block loyalty_reward_detail_smart_bar_actions_save %}\r\n                    <sw-button-process\r\n                            class="loyalty-reward-detail__save-action"\r\n                            :isLoading="isLoading"\r\n                            :processSuccess="processSuccess"\r\n                            variant="primary"\r\n                            :disabled="disabled"\r\n                            @process-finish="saveFinish"\r\n                            @click="onClickSave">\r\n                        {{ $tc(\'loyalty-program.rewards.general.buttonSave\') }}\r\n                    </sw-button-process>\r\n                {% endblock %}\r\n            </template>\r\n        {% endblock %}\r\n\r\n        {% block loyalty_reward_detail_content %}\r\n            <template #content>\r\n                <sw-card-view>\r\n\r\n                    {% block loyalty_reward_detail_content_settings_media_modal %}\r\n                        <sw-media-modal-v2\r\n                                v-if="showMediaModal"\r\n                                :allow-multi-select="false"\r\n                                :initial-folder-id="mediaDefaultFolderId"\r\n                                :entity-context="item.getEntityName()"\r\n                                @modal-close="showMediaModal = false"\r\n                                @media-modal-selection-change="onMediaSelectionChange"\r\n                        />\r\n                    {% endblock %}\r\n\r\n                    {% block loyalty_reward_detail_content_settings_main %}\r\n                        <sw-card :isLoading="isLoading" v-if="item"\r\n                                 :title="$tc(\'loyalty-program.rewards.general.settingsLabel\')">\r\n\r\n                        {% block loyalty_reward_detail_content_type %}\r\n                                <sw-single-select v-model:value="item.type"\r\n                                                  required\r\n                                                  show-clearable-button\r\n                                                  :options="typeOptions"\r\n                                                  class="loyalty-reward-detail__item_type"\r\n                                                  :label="$tc(\'loyalty-program.rewards.detail.fieldTitleLabelType\')"\r\n                                                  :helpText="$tc(\'loyalty-program.rewards.detail.fieldTitleHelpTextType\')"\r\n                                                  :placeholder="$tc(\'loyalty-program.rewards.detail.fieldTitlePlaceholderType\')">\r\n                                </sw-single-select>\r\n                        {% endblock %}\r\n\r\n                                {% block loyalty_reward_detail_content_points %}\r\n                                        <sw-number-field v-model:value="item.points"\r\n                                                         required\r\n                                                         class="loyalty-reward-detail__item_points"\r\n                                                         numberType="int"\r\n                                                         min="1"\r\n                                                         :label="$tc(\'loyalty-program.rewards.detail.fieldTitleLabelPoints\')"\r\n                                                         :helpText="$tc(\'loyalty-program.rewards.detail.fieldTitleHelpTextPoints\')"\r\n                                                         :placeholder="placeholder(item, \'points\', $tc(\'loyalty-program.rewards.detail.fieldTitlePlaceholderPoints\'))">\r\n                                        </sw-number-field>\r\n                                {% endblock %}\r\n\r\n                            {% block loyalty_reward_detail_content_name %}\r\n                                <sw-text-field v-model:value="item.name"\r\n                                               required\r\n                                               class="loyalty-reward-detail__item_name"\r\n                                               :label="$tc(\'loyalty-program.rewards.detail.fieldTitleLabelName\')"\r\n                                               :placeholder="$tc(\'loyalty-program.rewards.detail.fieldTitlePlaceholderName\')">\r\n                                </sw-text-field>\r\n                            {% endblock %}\r\n\r\n                            {% block loyalty_reward_detail_content_active_checkbox_select %}\r\n                                <sw-switch-field v-model:value="item.active"\r\n                                             class="loyalty-reward-detail__item_active"\r\n                                             :label="$tc(\'loyalty-program.rewards.detail.fieldTitleLabelActive\')"\r\n                                             :helpText="$tc(\'loyalty-program.rewards.detail.fieldTitleHelpTextActive\')">\r\n                                </sw-switch-field>\r\n                            {% endblock %}\r\n\r\n\r\n                            {% block loyalty_reward_detail_content_settings_image %}\r\n                                <sw-upload-listener\r\n                                        auto-upload\r\n                                        :upload-tag="uploadTag"\r\n                                        @media-upload-finish="onUploadMedia"\r\n                                />\r\n                                <sw-media-upload-v2\r\n                                        class="loyalty-program-rewards-image-upload"\r\n                                        :upload-tag="uploadTag"\r\n                                        :source="mediaItem"\r\n                                        :source-context="item"\r\n                                        :default-folder="mediaDefaultFolderId"\r\n                                        :label="$tc(\'loyalty-program.rewards.detail.fieldTitleLabelImage\')"\r\n                                        :allow-multi-select="false"\r\n                                        @media-drop="onDropMedia"\r\n                                        @media-upload-sidebar-open="onOpenMedia"\r\n                                        @media-upload-remove-image="onRemoveMedia"\r\n                                />\r\n                            {% endblock %}\r\n\r\n                        </sw-card>\r\n                    {% endblock %}\r\n\r\n\r\n                </sw-card-view>\r\n            </template>\r\n        {% endblock %}\r\n\r\n    </sw-page>\r\n{% endblock %}\r\n',inject:["repositoryFactory","context"],mixins:[n.getByName("notification"),n.getByName("placeholder")],data(){return{item:null,isLoading:!1,processSuccess:!1,repository:null,isSaveSuccess:!1,mediaItem:null,uploadTag:"loyalty-program-reward-upload-tag",mediaDefaultFolderId:null,showMediaModal:!1}},watch:{"item.media.id"(){this.item.media?.id&&this.setMediaItem({targetId:this.item.media.id})}},metaInfo(){return{title:this.$createTitle()}},created(){this.createdComponent()},computed:{mediaRepository(){return this.repositoryFactory.create("media")},typeOptions(){return[{label:this.$tc("loyalty-program.rewards.detail.typeProductOption"),value:"product"},{label:this.$tc("loyalty-program.rewards.detail.typeDiscountOption"),value:"discount"}]}},methods:{createdComponent(){this.repository=this.repositoryFactory.create("loyalty_reward"),this.isLoading=!0,this.loadAll().then(()=>{this.isLoading=!1})},loadAll(){return Promise.all([this.getEntity()])},getEntity(){let e=new l;return e.addAssociation("media"),this.repository.get(this.$route.params.id,Shopware.Context.api,e).then(e=>{this.item=e})},onClickSave(){this.isLoading=!0,this.isSaveSuccessful=!1,this.isLoading=!0,this.repository.save(this.item,Shopware.Context.api).then(()=>{this.getEntity(),this.isLoading=!1,this.processSuccess=!0,this.createNotificationSuccess({tilte:"SUCCESS",message:"SUCCESS MESSAGE"})}).catch(()=>{this.isLoading=!1,this.processSuccess=!0,this.createNotificationError({title:"ERROR",message:"ERROR MESSAGE"})})},saveFinish(){this.processSuccess=!1},onUploadMedia(e){this.setMediaItem({targetId:e.targetId})},onDropMedia(e){this.setMediaItem({targetId:e.id})},setMediaItem({targetId:e}){this.mediaRepository.get(e).then(e=>{this.mediaItem=e}),this.item.mediaId=e},onRemoveMedia(){this.mediaItem=null,this.item.mediaId=null},onOpenMedia(){this.showMediaModal=!0},onMediaSelectionChange([e]){this.mediaItem=e,this.item.mediaId=e.id},onChangeLanguage(){this.getEntity()}}});let{Component:i}=Shopware,o=Shopware.Utils;i.extend("loyalty-reward-create","loyalty-reward-detail",{template:"",beforeRouteEnter(e,t,a){e.name.includes("loyalty.program.rewards.create")&&!e.params.id&&(e.params.id=o.createId(),e.params.newItem=!0),a()},methods:{getEntity(){this.item=this.repository.create(Shopware.Context.api),this.item.active=!0},createdComponent(){Shopware.State.getters["context/isSystemDefaultLanguage"]||Shopware.State.commit("context/resetLanguageToDefault"),this.$super("createdComponent")},saveFinish(){this.isSaveSuccessful=!1,this.$router.push({name:"loyalty.program.rewards.detail",params:{id:this.item.id}})},onClickSave(){this.isLoading=!0,this.repository.save(this.item,Shopware.Context.api).then(()=>{this.isLoading=!1,this.createNotificationSuccess({title:"SUCCESS",message:"SUCCESS MESSAGE"}),this.$router.push({name:"loyalty.program.rewards.detail",params:{id:this.item.id}})}).catch(()=>{this.isLoading=!1,this.createNotificationError({title:"ERROR",message:"ERROR MESSAGE"})})}}});var s=JSON.parse('{"loyalty-program":{"general":{"mainMenuItemLabel":"Loyalty program","mainMenuItemDescription":"Loyalty program","rewardsLabel":"Rewards","rewardsSingularLabel":"Reward","redemptionsLabel":"Redemptions","campaignsLabel":"Campaigns","ranksLabel":"Ranks"},"rewards":{"general":{"create":"Add reward","buttonCancel":"Cancel","buttonSave":"Save","fieldTitleLabelName":"Name","fieldTitlePlaceholderName":"Name","settingsLabel":"Settings"},"list":{"contentEmpty":"No rewards found.","nameLabel":"Name","typeLabel":"Type","active":"Active","pointsLabel":"Points"},"detail":{"fieldTitleLabelImage":"Image","fieldTitleLabelName":"Name","fieldTitlePlaceholderName":"e.g. Reward 1000","fieldTitleLabelActive":"Active","fieldTitleHelpTextActive":"If not set, reward wont show in storefront and is nut redeemable","typeProductOption":"Product","typeDiscountOption":"Discount","fieldTitleLabelType":"Type","fieldTitleHelpTextType":"Discount creates coupon, product is product for cart wich can be added to order.","fieldTitlePlaceholderType":"Choose type","fieldTitleLabelPoints":"Points","fieldTitleHelpTextPoints":"Price in points","fieldTitlePlaceholderPoints":"1"}}}}'),d=JSON.parse('{"loyalty-program":{"general":{"mainMenuItemLabel":"Bonusprogramm","mainMenuItemDescription":"Bonusprogramm","rewardsLabel":"Belohnungen","redemptionsLabel":"Einl\xf6sungen","campaignsLabel":"Kampagnen","ranksLabel":"R\xe4nge"}}}');Shopware.Module.register("loyalty-program",{type:"core",name:"loyalty",title:"loyalty-program.general.mainMenuItemLabel",description:"loyalty-program.general.mainMenuItemDescription",color:"#189eff",icon:"regular-party-horn",snippets:{"de-DE":d,"en-GB":s},routes:{"rewards.index":{component:"loyalty-reward-list",path:"reward/index"},"rewards.detail":{component:"loyalty-reward-detail",path:"reward/detail/:id",meta:{parentPath:"loyalty.program.rewards.index"}},"rewards.create":{component:"loyalty-reward-create",path:"reward/create",meta:{parentPath:"loyalty.program.rewards.index"}}},navigation:[{id:"loyalty-program",label:"loyalty-program.general.mainMenuItemLabel",color:"#189eff",icon:"regular-party-horn",position:50},{id:"loyalty-rewards",parent:"loyalty-program",label:"loyalty-program.general.rewardsLabel",path:"loyalty.program.rewards.index",position:10},{id:"loyalty-redemptions",parent:"loyalty-program",label:"loyalty-program.general.redemptionsLabel",path:"sw.extension.store",position:10},{id:"loyalty-campaigns",parent:"loyalty-program",label:"loyalty-program.general.campaignsLabel",path:"sw.extension.store",position:10},{id:"loyalty-ranks",parent:"loyalty-program",label:"loyalty-program.general.ranksLabel",path:"sw.extension.store",position:10}]})}()}();